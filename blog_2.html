<!DOCTYPE html>
<html lang="en">
<head>
 <title>LabelBinarizer & LabelEncoder</title>
 <!-- Latest compiled and minified CSS -->
 <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha384-HSMxcRTRxnN+Bdg0JdbxYKrThecOKuH5zCYotlSAcp1+c8xmyTe9GYg1l9a69psu" crossorigin="anonymous">
 <div class="container">
  <h1><a href="https://codykane.github.io/blog">Blog</a></h1>
 </div>
</head>
<body>
 <div class="container">
<div class="row">
 <div class="col-md-8">
  <h3>LabelBinarizer & LabelEncoder</h3>
  <label>2019-07-04</label>
  <p>To avoid your machine learning model blowing up when you feed it data in production, it's necessary to give it numerical values, rather than categorical variables in the form of strings. There are a few different ways to go about this in your preprocessing flow, depending on whether the categories have relative weight, and whether the absolute values are important. </p>
<p>First we'll build a simple dataframe &amp; import the necessary packages.</p>
<div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">LabelEncoder</span><span class="p">,</span> <span class="n">LabelBinarizer</span>
<span class="kn">from</span> <span class="nn">sklearn_pandas</span> <span class="kn">import</span> <span class="n">DataFrameMapper</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="kn">as</span> <span class="nn">pd</span>

<span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;city&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Barcelona&#39;</span><span class="p">,</span> <span class="s1">&#39;Paris&#39;</span><span class="p">,</span> <span class="s1">&#39;Shanghai&#39;</span><span class="p">,</span> <span class="s1">&#39;Barcelona&#39;</span><span class="p">,</span> <span class="s1">&#39;Cairo&#39;</span><span class="p">],</span> <span class="s1">&#39;pop&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mf">1.6</span><span class="p">,</span> <span class="mf">2.1</span><span class="p">,</span> <span class="mf">26.3</span><span class="p">,</span> <span class="mf">1.6</span><span class="p">,</span>
                                                                                                <span class="mf">19.5</span><span class="p">]})</span>
<span class="n">df</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Barcelona</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Paris</td>
      <td>2.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Shanghai</td>
      <td>26.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Barcelona</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Cairo</td>
      <td>19.5</td>
    </tr>
  </tbody>
</table>
</div>

<p>To feed this into a machine learning algorithm, we'll need to convert the strings in the city column into integers. We'll use DataFrameMapper to apply this only to one column while keeping the others intact. For the rusty/uninitiated,                      <a href="https://ryankresse.com/convenient-preprocessing-with-sklearn_pandas-dataframemapper/">this</a> is a good resource. </p>
<div class="highlight"><pre><span></span><span class="c1">##LabelEncoder</span>
<span class="n">tp</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="n">LabelEncoder</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;pop&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>
<span class="n">mapper</span> <span class="o">=</span> <span class="n">DataFrameMapper</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">df_out</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">mapper</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>2.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>26.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>19.5</td>
    </tr>
  </tbody>
</table>
</div>

<div class="highlight"><pre><span></span><span class="c1">##LabelBinarizer</span>
<span class="n">tp</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="n">LabelBinarizer</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;pop&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>
<span class="n">mapper</span> <span class="o">=</span> <span class="n">DataFrameMapper</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">df_out</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">mapper</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>city_Barcelona</th>
      <th>city_Cairo</th>
      <th>city_Paris</th>
      <th>city_Shanghai</th>
      <th>pop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>2.1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>26.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>19.5</td>
    </tr>
  </tbody>
</table>
</div>

<p>Now let's assume we're just interested in the population relative to the other cities, and not the absolute values. 
LabelBinarizer will be useless here as it will return columsn for unique values, but LabelEncoder will assign ranks to each of them, Barcelona being 0 as it has the smallest population, up to Cairo with the largest.</p>
<div class="highlight"><pre><span></span><span class="n">tp</span> <span class="o">=</span> <span class="p">[(</span><span class="s1">&#39;pop&#39;</span><span class="p">,</span> <span class="n">LabelEncoder</span><span class="p">()),</span> <span class="p">(</span><span class="s1">&#39;city&#39;</span><span class="p">,</span> <span class="bp">None</span><span class="p">)]</span>
<span class="n">mapper</span> <span class="o">=</span> <span class="n">DataFrameMapper</span><span class="p">(</span><span class="n">tp</span><span class="p">,</span> <span class="n">df_out</span><span class="o">=</span><span class="bp">True</span><span class="p">)</span>
<span class="n">mapper</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>
</pre></div>


<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>pop</th>
      <th>city</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
      <td>Barcelona</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>Paris</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>Shanghai</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0</td>
      <td>Barcelona</td>
    </tr>
    <tr>
      <th>4</th>
      <td>2</td>
      <td>Cairo</td>
    </tr>
  </tbody>
</table>
</div>

<p>Take note that LabelEncoder will assign ascending values based on the alphabetical value of the strings, as seen in 'df' above, where Barcelona is 0, Cairo 1 etc. If the label is binary, like male/female, LabelEncoder will return zeroes and ones, which is preferable over LabelBinarizer due to it being one column, whereas Labelbinarizer would create two, one in which male is positive (1) and one where female is. LabelEnconder has another use, when categorical data has relative weight (ex: hate, dislike, neutral, like, love on a questionnaire) that needs to be encoded.  Otherwise, when the categories are unrelated, for example neighbourhoods, assigning one neighbourhood "a" 1 and neighbourhood "b" 2 can lead your algorithm to think that neighbourhood "b" = 2 * neighbourhood "a", which can cause a lot of problems. While the more common approach to convert categorical features into binary seems to be OneHotEncoder,  LabelBinarizer does exactly the same thing, and I've found that LabelBinarizer's implementation is marginally simpler. </p>
<div class="highlight"><pre><span></span><span class="n">For</span> <span class="n">some</span> <span class="n">other</span> <span class="n">resources</span> <span class="n">on</span> <span class="n">how</span> <span class="n">to</span> <span class="n">implement</span> <span class="n">LabelEncoder</span> <span class="o">&amp;</span> <span class="n">Label</span> <span class="n">Binarizer</span><span class="p">,</span> <span class="n">I</span> <span class="n">recommend</span><span class="p">:</span> 

<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;https://machinelearningmastery.com/how-to-one-hot-encode-sequence-data-in-python/&quot;</span><span class="o">&gt;</span><span class="n">machinelearning</span><span class="o">.</span><span class="n">com</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;https://scikit-learn.org/stable/modules/generated/sklearn.preprocessing.LabelBinarizer.html&quot;</span><span class="o">&gt;</span><span class="n">LabelBinarizer</span> <span class="n">Documentation</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>

<span class="o">&lt;</span><span class="n">a</span> <span class="n">href</span><span class="o">=</span><span class="s2">&quot;https://towardsdatascience.com/encoding-categorical-features-21a2651a065c&quot;</span><span class="o">&gt;</span><span class="n">towardsdatascience</span><span class="o">.</span><span class="n">com</span><span class="o">&lt;/</span><span class="n">a</span><span class="o">&gt;</span>
</pre></div>
 </div>
</div>
 </div>
</body>
</html>